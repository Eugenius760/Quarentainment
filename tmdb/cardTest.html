<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test TMDB</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>
<body>

    <form id="movie-form">
        <label for="movie-input">Search for a movie</label>
        <input type="text" id="movie-input"><br>

        <input id="find-movie" type="submit" value="Movie Search">
      </form>
  
      <div id="movie-view"></div>

    <script>
        $("#find-movie").on("click", function(event) {


        event.preventDefault();

        var movie = $("#movie-input").val();
        var genreDiction = {
            10759:"Action & Adventure",
            16:"Animation",
            35:"Comedy",
            80:"Crime",
            99:"Documentary",
            18:"Drama",
            10751:"Family",
            10762:"Kids",
            9648:"Mystery",
            10763:"News",
            10764:"Reality",
            10765:"Sci-Fi & Fantasy",
            10766:"Soap",
            10767:"Talk",
            10768:"War & Politics",
            37:"Western",
            28:"Action",
            12:"Adventure",
            14:"Fantasy",
            36:"History",
            27:"Horror",
            10402:"Music",
            10749:"Romance",
            878:"Science Fiction",
            10770:"TV Movie",
            53:"Thriller",
            10752:"War",
        };

        var queryTMDB = "https://api.themoviedb.org/3/search/movie?api_key=660bf8330423e5658590b1cdb677dc08&language=en-US&query=" + movie
        $.ajax({
          url: queryTMDB,
          method: "GET"
        }).then(function(response) {
            // console.log(response);
            var myGenreid = response.results[0].genre_ids;
            var genString = "";
            for (var i = 0; i < myGenreid.length; i++) {
            //     var myGenreid = response.results[0].genre_ids[0]
            // console.log(genreDiction[myGenreid[i]])
            genString = genString + ", " + genreDiction[myGenreid[i]];
            }
            resString = genString.substring(2, );

            var movieDiv = $("<div class='movie'>");

            // title
            var mTitle = response.results[0].title;
            var title = $("<h1>").text(mTitle);
            movieDiv.append(title);

            //image
            var pic = response.results[0].poster_path
            var image = $("<img>").attr("src", "https://image.tmdb.org/t/p/w200" + pic)
            movieDiv.append(image);

            // score
            var score = $("<p>").text("Score: " + response.results[0].vote_average + " out of 10")
            movieDiv.append(score)

            // console.log(genreDiction[response.results[0].genre_ids[0]])
            // console.log(response.results[0].genre_ids[0]);
            var genre = $("<p>").text(resString)
            // movieDiv.append(genre)
            // console.log(genreDiction.response.results[0].genre_ids[0]);
            // var genre = $("<p>").text(genreDiction.response.results[0].genre_ids[0]);
            movieDiv.append(genre);

            var mOverview = $("<p>").text(response.results[0].overview)
            movieDiv.append(mOverview)

            $("#movie-view").prepend(movieDiv);
            // $("#movie-view").text(JSON.stringify(response.results[0].overview));
        });
        });

        var genre = "99"
        var genreQuery = "https://api.themoviedb.org/3/discover/movie?api_key=660bf8330423e5658590b1cdb677dc08&language=en-US&sort_by=popularity.desc&include_adult=false&include_video=false&page=1&with_genres=" + genre;

        $.ajax({
            url: genreQuery,
            method: "GET"
        }).then(function(response) {
            console.loog(response);

        });



    </script>
    
</body>
</html>