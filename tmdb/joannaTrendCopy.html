<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trending</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>

<body>

    <div id="movie-view"></div>
    <script>
        var trendURL = "https://api.themoviedb.org/3/trending/movie/day?api_key=660bf8330423e5658590b1cdb677dc08"
        // var apiKey = "660bf8330423e5658590b1cdb677dc08";
        
        var genreDiction = {
            10759:"Action & Adventure",
            16:"Animation",
            35:"Comedy",
            80:"Crime",
            99:"Documentary",
            18:"Drama",
            10751:"Family",
            10762:"Kids",
            9648:"Mystery",
            10763:"News",
            10764:"Reality",
            10765:"Sci-Fi & Fantasy",
            10766:"Soap",
            10767:"Talk",
            10768:"War & Politics",
            37:"Western",
            28:"Action",
            12:"Adventure",
            14:"Fantasy",
            36:"History",
            27:"Horror",
            10402:"Music",
            10749:"Romance",
            878:"Science Fiction",
            10770:"TV Movie",
            53:"Thriller",
            10752:"War",
        };


        // console.log(genreDiction);
        // console.log(genreDiction[12])
        // console.log(Object.values(genreDiction));
        // console.log(Object.entries(genreDiction));

        var genreNum;

        function numToGenre(str) {
            var genreDictionArr = Object.entries(genreDiction);
            console.log(genreDictionArr);

            for (var i = 0; i < genreDictionArr.length; i++) {
                if (str === genreDictionArr[i][1]) {
                    genreNum = genreDictionArr[i][0];
                }
            }

            return(genreNum);
        };

        numToGenre("Documentary")

        var genre = genreNum;
        var genreQuery = "https://api.themoviedb.org/3/discover/movie?api_key=660bf8330423e5658590b1cdb677dc08&language=en-US&sort_by=popularity.desc&include_adult=false&include_video=false&page=1&with_genres=" + genre;

        $.ajax({
            url: genreQuery,
            method: "GET"
        }).then(function (response) {
            console.log(response);
            for (var i = 0; i < response.results.length; i++) {
                var title = response.results[i].title;

                console.log(title);
            }

        });

        

        $.ajax({
            url: trendURL,
            method: "GET"
        }).then(function (response) {
            // console.log(response)

            for (var i = 0; i < response.results.length; i++) {
                
                var myGenreids = response.results[i].genre_ids;
                var anyString = ""
                for (var j = 0; j < myGenreids.length; j++) {
                    // console.log(genreDiction[myGenreids[j]])
                    // anyString.concat(genreDiction)
                    // anyString + "," + genreDiction[myGenreids[j]]
                    anyString = anyString + ", " + genreDiction[myGenreids[j]]
                 
                }
                var resString = anyString.substring(2,);
                // console.log(resString);
                // console.log(response.results[i].genre_ids);
                var moTrend = $("<div>");

                // title
                var mtitle = $("<h1>").text(response.results[i].title);
                moTrend.append(mtitle);

                //image
                var pic = response.results[i].poster_path
                var image = $("<img>").attr("src", "https://image.tmdb.org/t/p/w200" + pic)
                moTrend.append(image);


                // score
                var score = $("<p>").text("Score: " + response.results[i].vote_average + " out of 10");
                moTrend.append(score);

                //genre
                var genre = $("<p>").text(resString)
                moTrend.append(genre);

                //overview
                var mOverview = $("<p>").text(response.results[i].overview)
                moTrend.append(mOverview)
                // var moTrend = $("<p>").html(
                //     response.results[i].title + "<br/><img src= 'https://image.tmdb.org/t/p/w200" +
                //     response.results[i].poster_path + "'><br/>" +
                //     response.results[i].vote_average + "<br/>" +
                //     resString + "<br/>" +
                //     response.results[i].overview + "<br/>"
                
                $("#movie-view").append(moTrend)

            }
        });

    </script>

</body>

</html>